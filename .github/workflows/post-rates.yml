name: Post USD & Market Rates (Forouzanfar)

on:
  schedule:
    # Ø§Ø¬Ø±Ø§ 3 Ø¨Ø§Ø± Ø¯Ø± Ø±ÙˆØ² (UTC): 06:00, 12:00, 18:00
    # Ù…Ø¹Ø§Ø¯Ù„ ØªÙ‡Ø±Ø§Ù†: Ø­Ø¯ÙˆØ¯ 09:30ØŒ 15:30ØŒ 21:30
    - cron: '0 6,12,18 * * *'
  workflow_dispatch:

jobs:
  post:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.11'
      - name: Install deps
        run: pip install requests jdatetime hijri-converter
      - name: Run poster (rates)
        env:
          MODE: 'rates'
          TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          NAVASAN_API_KEY: ${{ secrets.NAVASAN_API_KEY }}
          TELEGRAM_CHANNEL: '@Foorouzanfar'
          TIMEZONE: 'Asia/Tehran'
          MESSAGE_HEADER: 'ğŸ“£ ØµØ±Ø§ÙÛŒ ÙØ±ÙˆØ²Ø§Ù†ÙØ± â€” Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†Ø±Ø®â€ŒÙ‡Ø§'
          SOURCE_LABEL: 'Ù†ÙˆØ³Ø§Ù†'
          HASHTAGS: '#Ø¯Ù„Ø§Ø± #ÛŒÙˆØ±Ùˆ #Ø³Ú©Ù‡ #Ø·Ù„Ø§ #Ø­ÙˆØ§Ù„Ù‡ #ØµØ±Ø§ÙÛŒ_ÙØ±ÙˆØ²Ø§Ù†ÙØ±'
          CHANNEL_HANDLE: '@Foorouzanfar'
          INCLUDE_CATEGORIES: 'cash,remittance,melli,goldcoin'
          TOP_N_PER_CATEGORY: '3'
          MIN_CHANGE_TOMAN: '300'   # Ø§Ú¯Ø± Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒ Ù‡Ù…ÛŒØ´Ù‡ Ù¾Ø³Øª Ø¨Ø¯Ù‡: '0'
        run: python rates_cron.py
