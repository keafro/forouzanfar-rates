name: Post USD & Market Rates (Forouzanfar)

on:
  schedule:
    # ุงุฌุฑุง 3 ุจุงุฑ ุฏุฑ ุฑูุฒ (UTC): 06:00, 12:00, 18:00
    # ูุนุงุฏู ุชูุฑุงู (UTC+3:30): 09:30ุ 15:30ุ 21:30
    - cron: '0 6,12,18 * * *'
  workflow_dispatch:

jobs:
  post:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      - name: Install deps
        run: pip install requests jdatetime hijri-converter

      - name: Run poster (rates)
        env:
          MODE: 'rates'
          # --- Secrets: ุญุชูุงู ุฏุฑ Settings > Secrets ุณุงุฎุชู ุจุงุด ---
          TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          NAVASAN_API_KEY: ${{ secrets.NAVASAN_API_KEY }}

          # --- ุชูุธูุงุช ูพุงู (ุฏูุฎูุงู) ---
          TELEGRAM_CHANNEL: '@Foorouzanfar'
          TIMEZONE: 'Asia/Tehran'
          MESSAGE_HEADER: '๐ฃ ุตุฑุงู ูุฑูุฒุงููุฑ โ ุจุฑูุฒุฑุณุงู ูุฑุฎโูุง'
          SOURCE_LABEL: 'ููุณุงู'
          HASHTAGS: '#ุฏูุงุฑ #ูุฑู #ุณฺฉู #ุทูุง #ุญูุงูู #ุตุฑุงู_ูุฑูุฒุงููุฑ'
          CHANNEL_HANDLE: '@Foorouzanfar'

          # ุฏุณุชูโูุง: cash=ุงุณฺฉูุงุณุ remittance=ุญูุงููุ melli=ููุ goldcoin=ุณฺฉู/ุทูุงุ crypto=ุฑูุฒุงุฑุฒ
          INCLUDE_CATEGORIES: 'cash,remittance,melli,goldcoin,crypto'

          # ูุฑ ุฏุณุชู ุญุฏุงฺฉุซุฑ ฺูุฏ ุฑุฏู ูุดุงู ุฏูุฏ (ุจุฑุง ุดููุบ ูุดุฏู ูพุงู)
          TOP_N_PER_CATEGORY: '4'

          # ุงฺฏุฑ ุชุบุฑ ุฏูุงุฑ ูุฑูุด ุชูุฑุงู ฺฉูุชุฑ ุงุฒ ุงู ููุฏุงุฑ (ุชููุงู) ุจูุฏุ ุงุฑุณุงู ูฺฉูุฏ. ุตูุฑ = ููุดู ุงุฑุณุงู.
          MIN_CHANGE_TOMAN: '0'
        run: python rates_cron.py
